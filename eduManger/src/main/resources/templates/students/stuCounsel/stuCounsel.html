<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/default}">
<head>
	<meta charset="UTF-8">
	<title>회원목록</title>
</head>
	<th:block layout:fragment="customTitle">
		<title>index</title>
	</th:block>
	
	<th:block layout:fragment="customContents">
		    <!-- **********************************************************************************************************************************************************
	        MAIN CONTENT
	        *********************************************************************************************************************************************************** -->
	<section id="main-content">
		<section class="wrapper">
			<div class="row">
				<div class="col-lg-9 main-chart">     			
       				<div class="content-panel">
						<div class="form-panel ">
							<h2>상담기록</h2>
							<br/>
							<br/>
							<table id="counselList" class="table table-striped table-advance table-hover">
								<thead>
									<tr>
										<th>상담코드</th>
										<th>등록자아이디</th>
										<th>학생아이디</th>
										<th>상담종류</th>
										<th>상담내용</th>
										<th>등록날자</th>
										<th>삭제</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="l:${stuCounselList}">
										<td th:text="${l.stu_counsel_code}"></td>
										<td th:text="${l.admin_id}"></td>
										<td th:text="${l.m_id}"></td>
										<td th:text="${l.counsel_cate}"></td>
										<td th:text="${l.counsel_desc}"></td>
										<td th:text="${l.counsel_date}"></td>										
										<td>
											<button class="btn btn-danger btn-xs btnDelete" data-toggle="modal" th:data-memberId="123"><i class="fa fa-trash-o "></i></button>
										</td>
									</tr>							    
								</tbody>
							</table>
						</div>
					</div>
				</div>
<!-- *********************right panel************************** -->
			
				<div class="col-lg-3 ds">
					<!--COMPLETED ACTIONS DONUTS CHART-->
					<div class="donut-main">
			<!-- **************조건입력창*************** -->
						<form action="/stuCounselSearch" method="post">
							<div class="row" >
								<div class="col-sm-4" >							
									<span class="input-group">
										<select name="sk" class="form-control">
											<option value="select">선택</option>
											<option value="a.member_id">아이디</option>
											<option value="a.ac_code">학원코드</option>
											<option value="member_name">이름</option>											
										</select>	
									</span>			 									  	
								</div>	
								<div class="col-sm-8">																		
									<div class="input-group">
										<input name="sv" type="text" class="form-control" placeholder="Search" >
										<span class="input-group-btn">
											<button type="submit" class="btn btn-theme">회원검색</button>									
										</span>
									</div>
								</div>
							</div>
						</form>			
			<!--  ***************조건입력END*************** -->
						<br/>
						<br/>
						<br/>
						<table class="table table-striped table-advance table-hover table-bordered">
							<thead>
								<tr>							
									<th>학원코드</th>
									<th>아이디</th>
									<th>이름</th>
									<th>성별</th>
									<th>조회</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="l:${stuList}">
									<td th:text="${l.ac_code}"></td>
						  			<td th:text="${l.m_id}"></td>
						  			<td th:text="${l.m_name}"></td>
						  			<td th:text="${l.m_gender}"></td>
									<td><a th:href="@{/stuCounselList(memberId=${l.m_id})}">조회</a></td>
								</tr>
							</tbody>
						</table>
					</div>
					<!-- /col-lg-3 -->
				</div>					
	<!--********************** 1panel End ****************-->
						
	<!-- ***********************상담목록 **************************-->
				<div class="col-lg-9 main-chart">     			
          			<div class="content-panel">
						<div class="form-panel">
							<form action="/stuCounselUdpate" class="form-horizontal style-form" method="post">
								<h2>상담내용</h2>
								<br/>
								<br/>
								<input id="memberId" name="m_id" type="hidden" th:value="${stuCounselUpdateForm.m_id}">
								<label for="title">제목</label>
								<input id="counsel_title" name="counsel_title" type="text" class="form-control" th:value="${stuCounselUpdateForm.counsel_title}">
								<br/>
								<label for="user">작성자</label>
								<input id="admin_id" name="admin_id" type="text" class="form-control" th:value="${stuCounselUpdateForm.admin_id}">
								<br/>
								<label for="comment">내용</label>
								<textarea id="counsel_desc" name="counsel_desc" class="form-control" rows="15"  th:text=${stuCounselUpdateForm.counsel_desc}></textarea>
								<br/>
								<label for="date">등록날자</label>
								<input id="counsel_date" name="counsel_date" type="date" class="form-control" th:value="${stuCounselUpdateForm.counsel_date}">
								<br/>
								<label for="etc">기타</label>
								<input id="counsel_etc" name="counsel_etc" type="text" class="form-control" th:value="${stuCounselUpdateForm.counsel_etc}">
								<br/>
								<button type="submit" class="btn btn-theme">저장</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</section>
	</section>
	<script type="text/javascript">
		$('#counselList tr').click(function(){
			//배열 선언
			var tdArr = new Array();
			
			//테이블 값들
			var tr = $(this);
			var td = tr.children();
			console.log('클릭한 테이블의 값들' + tr.text());	
			
			//반복문으로 배열에 테이블값 push
			td.each(function(i){
				tdArr.push(td.eq(i).text());
			});
			
			var counsel_code = td.eq(0).text();
			var mId = td.eq(2).text();
			
			//console.log('상담코드 <---' + counsel_code);
			
			location.href = '/stuCounselUpdateForm?counsel_code='+ counsel_code + '&mId=' + mId;
		});
	</script>
	</th:block>
</html>